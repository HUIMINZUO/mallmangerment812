#### 23-项目-用户管理-用户列表-新建组件-路由配置

1、Home.vue 开启了路由模式 index 值 -> path 值
2、home.vue main -> router.vue
3、新建 users.vue
4、router/index.js 在 Home 中的 children 配置 uesrs 的路由

## 2020-08-13 11:02 第二天

#### 01-项目-用户管理-用户列表--面包屑和搜索框

1、el-card 卡片 和 小容器
2、面包屑

```html
<el-breadcrumb separator-class="el-icon-arrow-right">
  <el-breadcrumb-item :to="{ path: '/' }">首页</el-breadcrumb-item>
  <el-breadcrumb-item>首页</el-breadcrumb-item>
  <el-breadcrumb-item>用户管理</el-breadcrumb-item>
  <el-breadcrumb-item>用户列表</el-breadcrumb-item>
</el-breadcrumb>
```

3、搜索框以及添加用户组件

```html
<el-row class="searchRow">
  <el-col>
    <el-input placeholder="请输入内容" v-model="query" class="inputSelect">
      <el-button slot="append" icon="el-icon-search"></el-button>
    </el-input>
    <el-button type="primary" round>添加用户</el-button>
  </el-col>
</el-row>
```

4、调整了搜索框和添加用户按钮的样式

#### 02-项目-用户管理-用户列表-引入表格组件

> el-table(data 数据源[]) > el-table-column(label 表头/prop="数据") -> 字符串数据

```html
<el-table :data="tableData" border style="width: 100%">
  <el-table-column prop="date" label="日期" width="180"> </el-table-column>
  <el-table-column prop="name" label="姓名" width="180"> </el-table-column>
  <el-table-column prop="address" label="地址"> </el-table-column>
</el-table>
<script>
  tableData: [
    {
      date: "2016-05-02",
      name: "王小虎",
      address: "上海市普陀区金沙江路 1518 弄"
    },
    {
      date: "2016-05-04",
      name: "王小虎",
      address: "上海市普陀区金沙江路 1517 弄"
    }
  ];
</script>
```

#### 3-项目-用户管理-用户列表-列表处理

> 按照效果，调整了表头的数量和 label
> Table-column Attributes 的 type 参数中说明了对应列的类型。如果设置了 selection 则显示多选框；如果设置了 index 则显示该行的索引（从 1 开始计算）；如果设置了 expand 则显示为一个可展开的按钮，类型为 string 字符串

#### f

```js
created() {
    this.getUserList();
  },
  methods: {
    // 获取用户列表的请求
    async getUserList() {
      const res = await this.$http.get(
        `users?query=${this.query}&pagenum=${this.pagenum}&pagesize=${this.pagesize}`
      );
      console.log(res);
    }
```

1、通过 methods:{getUserList(){发送数据}}
2、通过 created(){this.getUserList()} 拿到请求头的数据
3、在接口文档中，除了登录之外的所有的请求都需要进行授权，就是设置请求头
4、在 axios 文档中找到关于如何设置请求头的代码

```js
axios.defaults.headers.common["Authorization"] = AUTH_TOKEN;
```

```js
const AUTH_TOKEN = localStorage.getItem("token");
this.$http.defaults.headers.common["Authorization"] = AUTH_TOKEN;
```

5、发送请求，查看是否有数据返回到控制台上

#### 4-项目-用户管理-用户列表-渲染数据-一般数据

> 使用解构赋值，给 this.userlist = res.data.data.users
> 更改 prop=""里面的值

#### 5-项目-用户管理-用户列表-渲染数据-日期格式处理

1、在 main.js 中添加全局过滤器 fmedate
2、 使用 prop = "create_time | fmtdate" 是不行的
3、如果单元格内的内容只能显示文本

```html
<el-table-column prop="create_time" label="创建时间">
  {{ crate_time | fmtdate }}
</el-table-column>
```

4、此时需要给该内容加外层容器 template

```html
<el-table-column prop="create_time" label="创建时间">
  <template>
    {{ crate_time | fmtdate }}
  </template>
</el-table-column>
```

5、最终写法 -> slot-scope 作用：传值

> slot-scope 的值会自动去上一级找最外层标签 el-table 所绑定的数据 userlist
> slot-scope="scope",此时""=== userlist 数组
> scope.row 是数组的每个对象
> scope.row.create_time 我们要用的数据

```html
<el-table-column label="创建时间">
  <!-- 
          template 内部要用数据，设置slot-scope属性
         -->
  <!-- 
           slot-scope 的值 userlist 其实就是 el-table 绑定的数据 userlist
           userllist.row -> 数组的每个对象
          -->
  <template slot-scope="userlist">
    {{ userlist.row.crate_time | fmtdate }}
  </template>
</el-table-column>
```

#### 5-项目-用户管理-用户列表-渲染数据-日用户状态开关

> 1、使用饿了么 UI 组件库里面的 el-switch v-model="bool"

```html
<el-table-column label="用户状态">
  <template slot-scope="scope">
    <el-switch
      v-model="scope.row.mg_state"
      active-color="#13ce66"
      inactive-color="#ff4949"
    >
    </el-switch>
  </template>
</el-table-column>
```
